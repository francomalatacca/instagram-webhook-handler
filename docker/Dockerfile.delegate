FROM python:3.11-slim

# Install required tools
RUN apt-get update && apt-get install -y unzip curl git default-jre

# Install pip and AWS SAM CLI
RUN pip install --upgrade pip && pip install aws-sam-cli

# Download and unpack Harness delegate
WORKDIR /opt/harness-delegate
RUN curl -L https://app.harness.io/public/shared/delegates/delegate.tar.gz | tar -xz

# Entrypoint to start the delegate
ENTRYPOINT ["./start.sh"]
