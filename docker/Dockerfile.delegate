FROM python:3.11-slim

# Install dependencies
RUN apt-get update && apt-get install -y unzip curl git default-jre

# Install pip and SAM CLI
RUN pip install --upgrade pip && pip install aws-sam-cli

# Download Harness Delegate
WORKDIR /opt/harness-delegate
RUN curl -L https://app.harness.io/public/shared/delegates/delegate.tar.gz | tar -xz

# Set entrypoint to run the delegate
ENTRYPOINT ["./start.sh"]
